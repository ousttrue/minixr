<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>MiniXR</title>
    <script type="module">
      import { MiniXRRunSession } from "./index.mts";

      let session = null;

      function onLoad(ev) {
        console.log('onLoad');
        const button = document.getElementById("start");
        if (!navigator.xr) {
          button.disabled = true;
          console.error("no navigator.xr");
          return;
        }
        button.disabled = false;

        button.addEventListener("click", async (ev) => {
          console.log('click');
          if (session) {
            session.end();
            session = null;
            button.innerText = "start";
          } else {
            const XR_SESSION_TYPE = "immersive-vr";
            // const XR_SESSION_TYPE = 'inline';
            session = await navigator.xr.requestSession(XR_SESSION_TYPE);
            session.addEventListener("end", (ev) => {
              console.log("XRSession end");
            });
            MiniXRRunSession(session);
            button.innerText = "stop";
          }
        });
      }

      document.addEventListener("DOMContentLoaded", onLoad);
    </script>
  </head>
  <body>
    <button id="start" disabled>start webxr</button>
  </body>
</html>
